<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- yarilab docs content -->
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>edit app</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <link rel="shortcut icon" href="/static/ico/favicon.png">        
        <link href="/static/css/bootstrap.css" rel="stylesheet" type="text/css" />
        <link href="/static/css/docs.css" rel="stylesheet" type="text/css" />        
        <link href="/static/css/fontselector.css" rel="stylesheet" type="text/css" />                        
        <link href="/static/dashboard/css/font-awesome.css" rel="stylesheet" type="text/css" />         
        <link href="/static/css/style.css" rel="stylesheet" type="text/css" />
        <link href="/static/css/singleupload.css" rel="stylesheet" type="text/css" />    
        <link href="/static/css/sim.css" rel="stylesheet" type="text/css" />                
        <script src="/static/js/jquery-1.8.2.min.js"></script>
        <script src="/static/js/bootstrap.js"></script>                           
        <script src="/static/js/app.js"></script>  
        <script src="/static/js/jquery.fontselector.js"></script>
        <script src="/static/js/jquery.nicescroll.min.js"></script>                

        <!-- upload css stuff -->
        <link rel="stylesheet" href="/static/upload/css/jquery.fileupload.css">
        <link rel="stylesheet" href="/static/upload/css/jquery.fileupload-ui.css"> 
                
    </head>
    
    <body data-spy="scroll" data-target=".bs-docs-sidebar" data-twttr-rendered="true">
        {% include "/header.html" %}
        <div class="container">
            <br>
            <h1>Image Database Management</h1>
            <h2 class="lead">Query, Update, Analyse database </h2>
            <div>
                <ul class="nav nav-tabs">
                    <li><a href="/manage/projects/all">Update DB</a></li>
                    <li class="active"><a href="/query">Query DB</a></li>
                    <li><a href="/dashboard">Dashboard</a></li>
                </ul>
            </div>                
            
            <div class="orientation"> 
                <a class="orientation-item orientation-active" data-tiggzi-action="portrait" title="Portrait layout"> <i class="icon icon-phone portrait"></i> </a> <a class="orientation-item" data-tiggzi-action="landscape" title="Landscape layout"> <i class="icon icon-phone landscape"></i> </a> 
            </div>
                                     
            <div class="row" style="margin-top:-15px;">
                <div class="col-xs-12 col-sm-8 col-md-12">
	                <h3>Edit Mobile App <small>Only Android is available in beta version</small></h3>
	                <hr class="colorgraph">  
	                                  
	                <form id="mobile-edit-form" class="col-md-10 col-md-offset-0" method="POST" action="#" enctype="multipart/form-data">
                        {{ edit_mobile_form.hidden_tag() }}                    
		                <div class="col-lg-2 col-md-offset-2" >
                            <div class="form-group stretch {% if edit_mobile_form.splash_color.errors %} has-error {% endif %}">		                
                                <label>Splash screen color</label>
                                <input type="color" name="splash_color" id="splash_color" value="{{ edit_mobile_form.splash_color.data }}" />    
			                    <p class="col-sm-5 help-block">
                                {{ edit_mobile_form.splash_color.errors[0] }}
                                </p>                                                        
                            </div>                             		                
                            <div class="form-group stretch {% if edit_mobile_form.website.errors %} has-error {% endif %}">
			                    <label>Footer</label>
			                    <input type="text" name="website" id="website" class="form-control input-lg" placeholder="App Website" tabindex="3" value="{{ edit_mobile_form.website.data }}">
			                    <p class="col-sm-5 help-block">
                                {{ edit_mobile_form.website.errors[0] }}
                                </p>
		                    </div>
                            <div class="form-group stretch {% if edit_mobile_form.font.errors %} has-error {% endif %}">		                
                                <label>font</label>                                
                                <div id="fontSelect" class="fontSelect">
                                    <div class="arrow-down"></div>
                                </div>
			                    <p class="col-sm-5 help-block">
                                {{ edit_mobile_form.font.errors[0] }}
                                </p>                                                        
                            </div>         		                
                            <div class="form-group stretch {% if edit_mobile_form.font_size.errors %} has-error {% endif %}">		                
                                <label>font size</label>
                                <input type="range" name="font_size" id="font_size" min="5" max="50" step="2" value="{{ edit_mobile_form.font_size.data }}" /> 
                                <span id="selRange">{{ edit_mobile_form.font_size.data }}</span>
			                    <p class="col-sm-5 help-block">
                                {{ edit_mobile_form.font_size.errors[0] }}
                                </p>                                                       
                            </div>    
                            <div class="form-group stretch {% if edit_mobile_form.bold.errors %} has-error {% endif %}">		                
                                <label>
                                    {% if edit_mobile_form.bold.data %}
                                        Bold <input type="checkbox" name="bold" id="bold" value="edit" checked="checked"> 
                                    {% else %}
                                        Bold <input type="checkbox" name="bold" id="bold" value="edit"> 
                                    {% endif %}    
                                </label>
                            </div>                            
                            <div class="form-group stretch {% if edit_mobile_form.font_color.errors %} has-error {% endif %}">		                
                                <label>Font color</label>
                                <input type="color" name="font_color" id="font_color" value="{{ edit_mobile_form.font_color.data }}" />    
			                    <p class="col-sm-5 help-block">
                                {{ edit_mobile_form.font_color.errors[0] }}
                                </p>                                                        
                            </div> 
                            <div id="render-icon-image">  
                                <label>App icon image</label>
                                <img src="{{ edit_mobile_form.icon_url.data }}" />   
                            </div>                                                         
                        </div>    
                        
                        <!-- center side -->
                        <div  class="col-lg-3 col-md-offset-1" style="margin-left:80px;">
                            <div id="sim-container">
                                <div id="sim-area">
                                    <div id="sim-logo">
                                        <img src="/static/img/mail_logo.png" width="60px" height="30px" />
                                    </div>
                                    <div id="sim-website">{{ edit_mobile_form.website.data }}</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- right side -->
                        <div  class="col-lg-2 col-md-offset-1" style="margin-left:80px;">                                  
                            <!-- logo icon -->
                            <div class="col-xs-8 form-group stretch {% if edit_mobile_form.logo_url.errors %} has-error {% endif %}">
                                <div id="single-holder" class="dropzone logo" style="width: 210px; height: 200px;">
                                    <input id="logo-input" type="file" name="logo" style="position: absolute; display: block;">
                                    <!-- delete -->
                                    <div class="dropzone-tools">
                                        <div id="del-logo-btn" class="btn btn-danger btn-cancel" style="display: inline-block;"><i class="icon icon-trash icon-white"></i>
                                        </div>
                                    </div>    
                                    <!-- ./delete -->
                                    <div id="logo-holder-img"></div>                                    
                                </div>
                                <p id="logo-file-infos"></p>
                                <!--<p id="single-upload" class="hidden">
                                    <label>
                                        Drag & drop not supported, but you can still upload via this input field:<br>
                                        <input type="file">
                                    </label>
                                </p>    
                                <p id="holder-error"></p>-->                                                            
                                <p class="col-sm-5 help-block">
                                {{ edit_mobile_form.logo_url.errors[0] }}
                                </p>
                            </div>	                                                      
                            <!-- ./logo icon -->                               
                            <br>    
                            <!-- app icon -->
                            <div class="col-xs-8 form-group stretch {% if edit_mobile_form.icon_url.errors %} has-error {% endif %}">
                                <div id="single-holder2" class="dropzone icon" style="width: 210px; height: 200px;">
                                    <input id="icon-input" type="file" name="icon" style="position: absolute; display: block;">
                                    <!-- delete -->
                                    <div class="dropzone-tools">
                                        <div id="del-icon-btn" class="btn btn-danger btn-cancel" style="display: inline-block;"><i class="icon icon-trash icon-white"></i>
                                        </div>
                                    </div>    
                                    <!-- ./delete -->
                                    <div id="icon-holder-img"></div>                                    
                                </div>
                                <p id="icon-file-infos"></p>
                                <!--<p id="single-upload2" class="hidden">
                                    <label>
                                        Drag & drop not supported, but you can still upload via this input field:<br>
                                        <input type="file">
                                    </label>
                                </p>                                
                                <p id="holder-error2"></p>-->                                
                                <p class="col-sm-5 help-block">
                                {{ edit_mobile_form.icon_url.errors[0] }}
                                </p>
                            </div>	                                                      
                            <!-- ./app icon -->                                                                     
                        </div>  
                        
                        <!-- The global progress state -->
                        <div class="col-lg-5 fileupload-progress fade" style="clear:both; text-align:center;">
                            <!-- The global progress bar -->
                            <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                <div class="progress-bar progress-bar-success" style="width:0%;"></div>
                            </div>
                            <!-- The extended global progress state -->
                            <div class="progress-extended">&nbsp;</div>
                        </div>
                        <!-- ./ progress -->
                                       
		                <hr class="colorgraph">	 		                
       				    <div class="col-md-3 col-md-offset-4"><input id="submit-form" type="submit" value="Save" class="btn btn-primary btn-block start" tabindex="7"></div>
    				    <div class="col-md-3 col-md-offset-11"><input type="button" value="Cancel" onclick="window.location='/query';"class="btn btn-block" tabindex="7"></div> 
    				    
                        <!-- The table listing the files available for upload/download is hidden -->
                        <table role="presentation" class="table table-striped hide">
                            <tbody class="files" id="table_uploads_fill"></tbody>                            
                        </table>
                                                
		            </form> 		            
		        </div>       
		    </div> <!--./row -->                          
        </div>  <!--./container -->  

        <script>            
            $('#fontSelect').fontSelector({
                'hide_fallbacks' : true,
                'initial' : "{{ edit_mobile_form.font.data }}",
                'selected' : function(font) { 
                    $('#sim-website').css('font-family', font);
                 },
                'fonts' : [
                    'Arial,Arial,Helvetica,sans-serif',
                    'Arial Black,Arial Black,Gadget,sans-serif',
                    'Comic Sans MS,Comic Sans MS,cursive',
                    'Courier New,Courier New,Courier,monospace',
                    'Georgia,Georgia,serif',
                    'Impact,Charcoal,sans-serif',
                    'Lucida Console,Monaco,monospace',
                    'Lucida Sans Unicode,Lucida Grande,sans-serif',
                    'Palatino Linotype,Book Antiqua,Palatino,serif',
                    'Tahoma,Geneva,sans-serif',
                    'Times New Roman,Times,serif',
                    'Trebuchet MS,Helvetica,sans-serif',
                    'Verdana,Geneva,sans-serif',
                    'Gill Sans,Geneva,sans-serif'
                    ]
            });

            // init
            $("#sim-area").css("background-color", '{{ edit_mobile_form.splash_color.data }}'); 
            $("#sim-website").css("color", '{{ edit_mobile_form.font_color.data }}');
            $('#sim-website').text('{{ edit_mobile_form.website.data }}');            
            $("#sim-website").css("font-family", '{{ edit_mobile_form.font.data }}');                        
            $("#sim-website").css("font-size", {{ edit_mobile_form.font_size.data }}+"px");                        
            $("#selRange").html({{ edit_mobile_form.font_size.data }});
            if('{{ edit_mobile_form.bold.data }}' == 'True')                
                $("#sim-website").css("font-weight", "bold");
            else    
                $("#sim-website").css("font-weight", "normal");                                    
            //
            
                
            $("#splash_color").on("input", function() {
                $("#sim-area").css("background-color", $(this).val());            
            });
            $("#font_color").on('input', function() {     
                $("#sim-website").css("color", $(this).val());
            });                 
            $("#font_size").on("change", function() {
                $("#selRange").html($(this).val());
                $("#sim-website").css("font-size", $(this).val()+"px");
            });     
            $("#bold").on("change", function() {                
                if ($(this).is(':checked')) {
                    $("#sim-website").css("font-weight", "bold");
                }
                else {
                    $("#sim-website").css("font-weight", "normal");
                }
            });       
            $("#website").keyup(function(){ 
                $('#sim-website').text($(this).val());
            });       
        </script>  
        
        <!-- The jQuery UI widget factory, can be omitted if jQuery UI is already included -->
        <script src="/static/upload/js/jquery.ui.widget.js"></script>        
        <!-- The basic File Upload plugin -->
        <script src="/static/upload/js/jquery.fileupload.js"></script>
        <!-- The File Upload processing plugin -->
        <script src="/static/upload/js/jquery.fileupload-process.js"></script>       
        <!-- The File Upload validation plugin -->
        <script src="/static/upload/js/jquery.fileupload-validate.js"></script>        
        <!-- The File Upload user interface plugin -->
        <script src="/static/upload/js/jquery.fileupload-ui.js"></script>                  

        <script src="/static/js/singleupload.js"></script>                 
        
        <script>
            $(document).ready(function(){                
                $('#mobile-edit-form').fileupload({
                    url: '/query/edit',   
                    filesContainer: $('#table_uploads_fill'),
                    dropZone: $('.dropzone'),             
                    maxNumberOfFiles: 2,
                    downloadTemplate: function (o) {
                        window.location.replace("/query");
                    },
                    uploadTemplate: function (o) {                                                
                        var rows = $();
                        $.each(o.files, function (index, file) {                            
                            var row = $('<tr class="template-upload fade">' +                                
                                '<td class="file_upload_start">' +
                                (!o.files.error && !index && !o.options.autoUpload ?
                                    '<button class="btn start">Submit visual</button>' : '') +
                                '</td>'+    
                                (!index ? '<td class="file_upload_cancel"><button class="btn cancel">Cancel</button></td>' : '') +
                                '</td>' +
                                '</tr>');
                            row.find('.name').text(file.name);
                            row.find('.size').text(o.formatFileSize(file.size));
                            if (file.error) {
                                row.find('.error').text(file.error);
                            }                
                            rows = rows.add(row);
                        });         
                        return rows;
                    }/*,
                    drop: function (e, data) {
                        $.each(data.files, function (index, file) {
                            alert('Dropped file: ' + file.name);
                        });
                    },
                    change: function (e, data) {
                        $.each(data.files, function (index, file) {
                            alert('Selected file: ' + file.name);
                        });
                    }*/
                    
                 });
                 $('#mobile-edit-form').bind('filedownloadprocessstart', function(e, data) {
                    alert('cc');
                 });
                //visualisation
                $("#logo-input").change(function(){
                    $("#logo-holder-img").empty();   
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        $('#logo-holder-img').append('<img src="'+e.target.result+'"></img>');
                    }
                    reader.readAsDataURL(this.files[0]);                    
                    $("#logo-file-infos").text("logo imname: "+this.files[0].name);
                });
                $("#icon-input").change(function(){
                    $("#logo-holder-img").empty();   
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        $('#icon-holder-img').append('<img src="'+e.target.result+'"></img>');
                    }
                    reader.readAsDataURL(this.files[0]);          
                    $("#icon-file-infos").text("icon imname: "+this.files[0].name);                              
                });
                
                $("#del-logo-btn").click(function(){
                    $("#logo-holder-img").empty();
                    $("#single-holder").addClass("logo");
                    //TODO remove from fileupload table
                });

                $("#del-icon-btn").click(function(){
                    $("#icon-holder-img").empty();
                    $("#single-holder2").addClass("icon");
                    //TODO remove from fileupload table
                    $('.file_upload_cancel button').click();
                });
                
                $("#submit-form").click(function(e){
                    if ($("#table_uploads_fill > tr").length > 0) {
                        e.preventDefault(); 
                        $('.file_upload_start button').click();
                    }    
                });
                
            });
        </script>                    

        {% include "/footer.html" %}
    </body>
</html>              
